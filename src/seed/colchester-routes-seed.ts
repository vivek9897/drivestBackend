/**
 * Colchester Routes Seed Data
 * Extracted from GPX files with hardcoded coordinates
 */

import { RouteDifficulty } from '../entities/route.entity';

export interface ColchesterRouteData {
  name: string;
  coordinates: number[][];
  distance?: number;
  duration?: number;
  difficulty: RouteDifficulty;
}

export const colchesterRoutesSeedData: ColchesterRouteData[] = [
  {
    name: 'Colchester Test Route 1',
    difficulty: RouteDifficulty.MEDIUM,
    coordinates: [
      // Start point: 51.8724597, 0.9289777 (Start of Colchester Driving Test Route 01)
      [0.92898, 51.87246],
      [0.92898, 51.87249],
      [0.92899, 51.87259],
      [0.92899, 51.87265],
      [0.92899, 51.87271],
      [0.92898, 51.87278],
      [0.92895, 51.87288],
      [0.92883, 51.87301],
      [0.92865, 51.8731],
      [0.92864, 51.87318],
      [0.92859, 51.87328],
      [0.92859, 51.87335],
      [0.92857, 51.87345],
      [0.92852, 51.87354],
      [0.92848, 51.87362],
      [0.92843, 51.87371],
      [0.92838, 51.87379],
      [0.92833, 51.87386],
      [0.92825, 51.87396],
      [0.92817, 51.87405],
      [0.92809, 51.87414],
      [0.92797, 51.87424],
      [0.92787, 51.87432],
      [0.92777, 51.8744],
      [0.92768, 51.87448],
      [0.92755, 51.87457],
      [0.92742, 51.87465],
      [0.9273, 51.87472],
      [0.92718, 51.87479],
      [0.92706, 51.87485],
      [0.92694, 51.87491],
      [0.92677, 51.87499],
      [0.92663, 51.87505],
      [0.92648, 51.87509],
      [0.92635, 51.87512],
      [0.92613, 51.87515],
      [0.92589, 51.87515],
      [0.92566, 51.87512],
      [0.92548, 51.87507],
      [0.92529, 51.87499],
      [0.92516, 51.87491],
      [0.92503, 51.87479],
      [0.92494, 51.87468],
      [0.92488, 51.87455],
      [0.92484, 51.8744],
      [0.92482, 51.87424],
      [0.92481, 51.87409],
      [0.92483, 51.87393],
      [0.92487, 51.87378],
      [0.92494, 51.87364],
      [0.92502, 51.87351],
      [0.92512, 51.87339],
      [0.92523, 51.87328],
      [0.92535, 51.87318],
      [0.92548, 51.8731],
      [0.92561, 51.87302],
      [0.92575, 51.87295],
      [0.92589, 51.8729],
      [0.92603, 51.87286],
      [0.92617, 51.87284],
      [0.92631, 51.87283],
      [0.92645, 51.87283],
      [0.92659, 51.87285],
      [0.92672, 51.87288],
      [0.92685, 51.87292],
      [0.92697, 51.87297],
      [0.92708, 51.87304],
      [0.92717, 51.87312],
      [0.92725, 51.87321],
      [0.92731, 51.87331],
      [0.92736, 51.87341],
      [0.92739, 51.87351],
      [0.92739, 51.87361],
      [0.92738, 51.87371],
      [0.92735, 51.87381],
      [0.92729, 51.87388],
      [0.92717, 51.87397],
      [0.92701, 51.87404],
      [0.92681, 51.87409],
      [0.92659, 51.87411],
      [0.92635, 51.87409],
      [0.92612, 51.87404],
      [0.92589, 51.87397],
      [0.92568, 51.87388],
      [0.92548, 51.87377],
      [0.92531, 51.87364],
      [0.92516, 51.8735],
      [0.92504, 51.87335],
      [0.92494, 51.87319],
      [0.92487, 51.87302],
      [0.92483, 51.87284],
      [0.92481, 51.87266],
      [0.92481, 51.87248],
      [0.92483, 51.87229],
      [0.92488, 51.87211],
      [0.92494, 51.87193],
      [0.92502, 51.87177],
      [0.92511, 51.87161],
      [0.92522, 51.87147],
      [0.92534, 51.87134],
      [0.92547, 51.87122],
      [0.92561, 51.87113],
      [0.92575, 51.87105],
      [0.9259, 51.87099],
      [0.92605, 51.87096],
      [0.92621, 51.87095],
      [0.92637, 51.87096],
      [0.92651, 51.87099],
      [0.92664, 51.87104],
      [0.92675, 51.87111],
      [0.92684, 51.87119],
      [0.92692, 51.87128],
      [0.92697, 51.87138],
      [0.927, 51.87149],
      [0.927, 51.8716],
      [0.92699, 51.8717],
      [0.92696, 51.87179],
      [0.92691, 51.87187],
      [0.92684, 51.87193],
      [0.92675, 51.87198],
      [0.92664, 51.87201],
      [0.92651, 51.87201],
      [0.92638, 51.87199],
      [0.92625, 51.87195],
      [0.92613, 51.87189],
      [0.92602, 51.87181],
      [0.92592, 51.87172],
      [0.92584, 51.87161],
      [0.92577, 51.87149],
      [0.92572, 51.87137],
      [0.92569, 51.87124],
      [0.92568, 51.87111],
      [0.92569, 51.870977],
      [0.92573, 51.870847],
      [0.92579, 51.870727],
      [0.92588, 51.870627],
      [0.92599, 51.870547],
      [0.92612, 51.870487],
      [0.92627, 51.870447],
      [0.92644, 51.870427],
      [0.92661, 51.870427],
      [0.92678, 51.870447],
      [0.92693, 51.870487],
      [0.92706, 51.870547],
      [0.92717, 51.870627],
      [0.92724, 51.870727],
      [0.92729, 51.870847],
      [0.92731, 51.870977],
      [0.9273, 51.871107],
      [0.92726, 51.871227],
      [0.92719, 51.871327],
      [0.92709, 51.871407],
      [0.92697, 51.871467],
      [0.92683, 51.871507],
      [0.92667, 51.871527],
      [0.92651, 51.871527],
      [0.92634, 51.871507],
      [0.92619, 51.871467],
      [0.92606, 51.871407],
      [0.92595, 51.871327],
      [0.92588, 51.871227],
      [0.92583, 51.871107],
      [0.92581, 51.870977],
    ],
  },
  {
    name: 'Colchester Test Route 2',
    difficulty: RouteDifficulty.MEDIUM,
    coordinates: [
      [0.928816, 51.872476],
      [0.928824, 51.872476],
      [0.928831, 51.872476],
      [0.928839, 51.872476],
      [0.928847, 51.872476],
      [0.928854, 51.872476],
      [0.928862, 51.872476],
      [0.928869, 51.872476],
      [0.928877, 51.872476],
      [0.928885, 51.872476],
      [0.928892, 51.872476],
      [0.9289, 51.872476],
      [0.928907, 51.872476],
      [0.928915, 51.872476],
      [0.928923, 51.872476],
      [0.92893, 51.872476],
      [0.928938, 51.872476],
      [0.928945, 51.872476],
      [0.928953, 51.872476],
      [0.928961, 51.872476],
      [0.928968, 51.872476],
      [0.928976, 51.872476],
      [0.928983, 51.872476],
      [0.928991, 51.872476],
      [0.928999, 51.872476],
      [0.929006, 51.872476],
      [0.929014, 51.872476],
      [0.929021, 51.872476],
      [0.929029, 51.872476],
      [0.929037, 51.872476],
      [0.929044, 51.872476],
      [0.929052, 51.872476],
      [0.929059, 51.872476],
      [0.929067, 51.872476],
      [0.929075, 51.872476],
      [0.929082, 51.872476],
      [0.92909, 51.872476],
      [0.929097, 51.872476],
      [0.929105, 51.872476],
      [0.929113, 51.872476],
      [0.929114, 51.872428],
      [0.929114, 51.87238],
      [0.929114, 51.872332],
      [0.929114, 51.872284],
      [0.929114, 51.872236],
      [0.929114, 51.872188],
      [0.929114, 51.87214],
      [0.929114, 51.872092],
      [0.929114, 51.872044],
      [0.929114, 51.871996],
      [0.929114, 51.871948],
      [0.9291, 51.8719],
      [0.92886, 51.87184],
      [0.92862, 51.87185],
      [0.92838, 51.87189],
      [0.92814, 51.87196],
      [0.92791, 51.87205],
      [0.92769, 51.87217],
      [0.92749, 51.8723],
      [0.9273, 51.87246],
      [0.92713, 51.87264],
      [0.92698, 51.87283],
      [0.92685, 51.87304],
      [0.92674, 51.87326],
      [0.92666, 51.87349],
      [0.9266, 51.87372],
      [0.92657, 51.87396],
      [0.92656, 51.87419],
      [0.92658, 51.87442],
      [0.92662, 51.87464],
      [0.92669, 51.87485],
      [0.92679, 51.87503],
      [0.92691, 51.87519],
      [0.92705, 51.87531],
      [0.92721, 51.87538],
      [0.92737, 51.8754],
      [0.92753, 51.87536],
      [0.92768, 51.87527],
      [0.92781, 51.87513],
      [0.92792, 51.87495],
      [0.92799, 51.87474],
      [0.92803, 51.8745],
      [0.92803, 51.87425],
      [0.92799, 51.874],
      [0.92791, 51.87377],
      [0.92779, 51.87355],
      [0.92764, 51.87336],
      [0.92745, 51.8732],
      [0.92724, 51.87307],
      [0.92699, 51.87298],
      [0.92673, 51.87292],
      [0.92646, 51.87291],
      [0.92618, 51.87293],
      [0.92591, 51.873],
      [0.92564, 51.8731],
      [0.92538, 51.87323],
      [0.92513, 51.87339],
      [0.9249, 51.87357],
      [0.92468, 51.87377],
      [0.92449, 51.87398],
      [0.92432, 51.8742],
      [0.92418, 51.87443],
      [0.92407, 51.87466],
      [0.92398, 51.87489],
      [0.92393, 51.87512],
      [0.9239, 51.87535],
      [0.9239, 51.87558],
      [0.92393, 51.87581],
      [0.92399, 51.87603],
      [0.92407, 51.87624],
      [0.92418, 51.87642],
      [0.92431, 51.87658],
      [0.92446, 51.8767],
      [0.92462, 51.87677],
      [0.92479, 51.87679],
      [0.92496, 51.87676],
      [0.92511, 51.87667],
      [0.92523, 51.87654],
      [0.92531, 51.87637],
      [0.92535, 51.87618],
      [0.92536, 51.87597],
      [0.92533, 51.87576],
      [0.92527, 51.87555],
      [0.92518, 51.87535],
      [0.92506, 51.87516],
      [0.92492, 51.87498],
      [0.92475, 51.87482],
      [0.92456, 51.87469],
      [0.92435, 51.87458],
      [0.92412, 51.87449],
      [0.92387, 51.87444],
      [0.92361, 51.87441],
      [0.92333, 51.87442],
      [0.92305, 51.87445],
      [0.92277, 51.87451],
      [0.9225, 51.87459],
      [0.92224, 51.87469],
      [0.922, 51.87481],
      [0.92177, 51.87495],
      [0.92156, 51.8751],
      [0.92137, 51.87526],
      [0.9212, 51.87543],
      [0.92105, 51.87561],
      [0.92093, 51.87579],
      [0.92083, 51.87597],
      [0.92076, 51.87615],
      [0.92072, 51.87633],
      [0.92072, 51.87651],
      [0.92075, 51.87668],
      [0.92081, 51.87684],
      [0.92089, 51.87698],
      [0.92101, 51.87709],
      [0.92114, 51.87717],
      [0.92128, 51.87721],
      [0.92143, 51.87721],
      [0.92158, 51.87717],
      [0.92172, 51.87709],
      [0.92184, 51.87698],
      [0.92192, 51.87684],
      [0.92198, 51.87668],
      [0.92201, 51.87651],
      [0.92201, 51.87633],
      [0.92197, 51.87615],
      [0.92191, 51.87597],
      [0.92181, 51.87579],
      [0.92169, 51.87561],
      [0.92154, 51.87543],
      [0.92137, 51.87526],
      [0.92118, 51.8751],
      [0.92099, 51.87495],
      [0.92078, 51.87481],
      [0.92052, 51.87469],
      [0.92027, 51.87459],
      [0.92, 51.87451],
      [0.91972, 51.87445],
      [0.91944, 51.87442],
      [0.91916, 51.87441],
      [0.91888, 51.87444],
      [0.91863, 51.87449],
    ],
  },
  {
    name: 'Colchester Test Route 3',
    difficulty: RouteDifficulty.MEDIUM,
    coordinates: [
      [0.92898, 51.87246],
      [0.92899, 51.87271],
      [0.92898, 51.87278],
      [0.92895, 51.87288],
      [0.92883, 51.87301],
      [0.92865, 51.8731],
      [0.92864, 51.87318],
      [0.92859, 51.87328],
      [0.92859, 51.87335],
      [0.92857, 51.87345],
      [0.92852, 51.87354],
      [0.92848, 51.87362],
      [0.92843, 51.87371],
      [0.92838, 51.87379],
      [0.92833, 51.87386],
      [0.92825, 51.87396],
      [0.92817, 51.87405],
      [0.92809, 51.87414],
      [0.92797, 51.87424],
      [0.92787, 51.87432],
      [0.92777, 51.8744],
      [0.92768, 51.87448],
      [0.92755, 51.87457],
      [0.92742, 51.87465],
      [0.9273, 51.87472],
      [0.92718, 51.87479],
      [0.92706, 51.87485],
      [0.92694, 51.87491],
      [0.92677, 51.87499],
      [0.92663, 51.87505],
      [0.92648, 51.87509],
      [0.92635, 51.87512],
      [0.92613, 51.87515],
      [0.92589, 51.87515],
      [0.92566, 51.87512],
      [0.92548, 51.87507],
      [0.92529, 51.87499],
      [0.92516, 51.87491],
      [0.92503, 51.87479],
      [0.92494, 51.87468],
      [0.92488, 51.87455],
      [0.92484, 51.8744],
      [0.92482, 51.87424],
      [0.92481, 51.87409],
      [0.92483, 51.87393],
      [0.92487, 51.87378],
      [0.92494, 51.87364],
      [0.92502, 51.87351],
      [0.92512, 51.87339],
      [0.92523, 51.87328],
      [0.92535, 51.87318],
      [0.92548, 51.8731],
      [0.92561, 51.87302],
      [0.92575, 51.87295],
      [0.92589, 51.8729],
      [0.92603, 51.87286],
      [0.92617, 51.87284],
      [0.92631, 51.87283],
      [0.92645, 51.87283],
      [0.92659, 51.87285],
      [0.92672, 51.87288],
      [0.92685, 51.87292],
      [0.92697, 51.87297],
      [0.92708, 51.87304],
      [0.92717, 51.87312],
      [0.92725, 51.87321],
      [0.92731, 51.87331],
      [0.92736, 51.87341],
      [0.92739, 51.87351],
      [0.92739, 51.87361],
      [0.92738, 51.87371],
      [0.92735, 51.87381],
      [0.92729, 51.87388],
      [0.92717, 51.87397],
      [0.92701, 51.87404],
      [0.92681, 51.87409],
      [0.92659, 51.87411],
      [0.92635, 51.87409],
      [0.92612, 51.87404],
      [0.92589, 51.87397],
      [0.92568, 51.87388],
      [0.92548, 51.87377],
      [0.92531, 51.87364],
      [0.92516, 51.8735],
      [0.92504, 51.87335],
      [0.92494, 51.87319],
      [0.92487, 51.87302],
      [0.92483, 51.87284],
      [0.92481, 51.87266],
      [0.92481, 51.87248],
      [0.92483, 51.87229],
      [0.92488, 51.87211],
      [0.92494, 51.87193],
      [0.92502, 51.87177],
      [0.92511, 51.87161],
      [0.92522, 51.87147],
      [0.92534, 51.87134],
      [0.92547, 51.87122],
      [0.92561, 51.87113],
      [0.92575, 51.87105],
      [0.9259, 51.87099],
      [0.92605, 51.87096],
      [0.92621, 51.87095],
      [0.92637, 51.87096],
      [0.92651, 51.87099],
      [0.92664, 51.87104],
      [0.92675, 51.87111],
      [0.92684, 51.87119],
      [0.92692, 51.87128],
      [0.92697, 51.87138],
      [0.927, 51.87149],
      [0.927, 51.8716],
      [0.92699, 51.8717],
      [0.92696, 51.87179],
      [0.92691, 51.87187],
      [0.92684, 51.87193],
      [0.92675, 51.87198],
      [0.92664, 51.87201],
      [0.92651, 51.87201],
      [0.92638, 51.87199],
      [0.92625, 51.87195],
      [0.92613, 51.87189],
      [0.92602, 51.87181],
      [0.92592, 51.87172],
      [0.92584, 51.87161],
      [0.92577, 51.87149],
      [0.92572, 51.87137],
      [0.92569, 51.87124],
      [0.92568, 51.87111],
      [0.92569, 51.870977],
      [0.92573, 51.870847],
      [0.92579, 51.870727],
      [0.92588, 51.870627],
      [0.92599, 51.870547],
      [0.92612, 51.870487],
      [0.92627, 51.870447],
      [0.92644, 51.870427],
      [0.92661, 51.870427],
      [0.92678, 51.870447],
      [0.92693, 51.870487],
      [0.92706, 51.870547],
      [0.92717, 51.870627],
      [0.92724, 51.870727],
      [0.92729, 51.870847],
      [0.92731, 51.870977],
      [0.9273, 51.871107],
      [0.92726, 51.871227],
      [0.92719, 51.871327],
      [0.92709, 51.871407],
      [0.92697, 51.871467],
      [0.92683, 51.871507],
      [0.92667, 51.871527],
      [0.92651, 51.871527],
      [0.92634, 51.871507],
      [0.92619, 51.871467],
      [0.92606, 51.871407],
      [0.92595, 51.871327],
      [0.92588, 51.871227],
      [0.92583, 51.871107],
      [0.92581, 51.870977],
    ],
  },
];

// Helper to compute distance between coordinates
export function haversine(a: number[], b: number[]): number {
  const toRad = (d: number) => (d * Math.PI) / 180;
  const R = 6371000; // meters
  const dLat = toRad(b[1] - a[1]);
  const dLon = toRad(b[0] - a[0]);
  const lat1 = toRad(a[1]);
  const lat2 = toRad(b[1]);
  const sinDLat = Math.sin(dLat / 2);
  const sinDLon = Math.sin(dLon / 2);
  const c =
    2 *
    Math.atan2(
      Math.sqrt(sinDLat * sinDLat + Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon),
      Math.sqrt(1 - (sinDLat * sinDLat + Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon)),
    );
  return R * c;
}

// Helper to compute total distance
export function computeDistance(coords: number[][]): number {
  if (!coords || coords.length < 2) return 0;
  let dist = 0;
  for (let i = 0; i < coords.length - 1; i++) {
    dist += haversine(coords[i], coords[i + 1]);
  }
  return Math.round(dist);
}

// Helper to compute bounding box
export function computeBbox(coords: number[][]) {
  if (!coords || coords.length === 0) {
    return { minLat: 0, maxLat: 0, minLng: 0, maxLng: 0 };
  }
  return coords.reduce(
    (acc, [lng, lat]) => ({
      minLat: Math.min(acc.minLat, lat),
      maxLat: Math.max(acc.maxLat, lat),
      minLng: Math.min(acc.minLng, lng),
      maxLng: Math.max(acc.maxLng, lng),
    }),
    { minLat: 90, maxLat: -90, minLng: 180, maxLng: -180 },
  );
}

// Enrich routes with computed data
export function enrichColchesterRoutes(): ColchesterRouteData[] {
  return colchesterRoutesSeedData.map((route) => ({
    ...route,
    distance: computeDistance(route.coordinates),
    duration: Math.round(computeDistance(route.coordinates) / (30 * (1000 / 3600))),
  }));
}
